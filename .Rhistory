version
install.packages('Deseq2')
BiocManager::install(MaAsLin2)
BiocManager::install("Maaslin2")
library(Maaslin2)
#load the data
data("Samples.txt") #load the example dataset
setwd("D:/2nd_sem/NGS/FINALS/MaAslin2_project3")
#load the data
data("D:/2nd_sem/NGS/FINALS/MaAslin2_project3/Samples.txt") #load the example dataset
#load the data
data("D:\2nd_sem\NGS\FINALS\MaAslin2_project3\Samples.txt") #load the example dataset
#load the data
data("D:\\2nd_sem\\NGS\\FINALS\\MaAslin2_project3\\Samples.txt") #load the example dataset
#load the data
data("D:\2nd_sem\NGS\FINALS\MaAslin2_project3\Samples.txt") #load the example dataset
#load the data
data <- read.table("Samples.txt", header = TRUE, row.names = 1) #load the data file
#perform association testing
result <- Maaslin2(data = IBD$data, metadata = IBD$metadata, fixed_effects = c("disease"), random_effects = c("subject"), min_abundance = 0.01)
metadata <- read.table("Metadata.txt", header = TRUE, row.names = 1) #load the metadata file
#load the data
input_data = system.file("extdata", "HMP2_taxonomy.tsv", package="Maaslin2") # The abundance table file
#load the data
input_data = system.file("Samples.txt", package="Maaslin2") # The abundance table file
input_data
#load the data
input_data = ("Samples.txt") # The abundance table file
input_data
#load the samples data
samples_data <- read.table("Samples.txt", header=TRUE, row.names=1, sep="\t")
#load the metadata
metadata <- read.table("Metadata.txt", header=TRUE, row.names=1, sep="\t")
View(metadata)
View(samples_data)
#load pathway data
pathway_data <- read.table("pathway_data.txt", header=TRUE, row.names=1, sep="\t")
#load pathway data
pathway_data <- read.table("Pathways.txt", header=TRUE, row.names=1, sep="\t")
View(pathway_data)
samples_data[1:5, 1:5]
fit_data = Maaslin2(input_data     = samples_data,
input_metadata = metadata,
min_prevalence = 0,
normalization  = "TSS",
output         = "demo_output",
fixed_effects  = c("diagnosis", "dysbiosis"),
reference      = c("diagnosis,nonIBD"))
load("D:/2nd_sem/NGS/FINALS/MaAslin2_project3/.RData")
View(metadata)
View(pathway_data)
View(samples_data)
unstrat_pathways <-function(pathway_data){
temp = pathway_data[!grepl("\\|",rownames(dat_path)),]
return(temp)
}
df_input_path = unstrat_pathways(samples_data)
samples_data = unstrat_pathways(samples_data)
pathway_data = unstrat_pathways(pathway_data)
unstrat_pathways <-function(dat_path){
temp = dat_path[!grepl("\\|",rownames(dat_path)),]
return(temp)
}
pathway_data = unstrat_pathways(pathway_data)
fit_func = Maaslin2(input_data     = pathway_data,
input_metadata = metadata,,
output         = "demo_functional",
fixed_effects  = c("diagnosis", "dysbiosis"),
reference      = c("diagnosis,nonIBD"),
min_abundance  = 0.0001,
min_prevalence = 0.1)
library(Maaslin2)
fit_func = Maaslin2(input_data     = pathway_data,
input_metadata = metadata,,
output         = "demo_functional",
fixed_effects  = c("diagnosis", "dysbiosis"),
reference      = c("diagnosis,nonIBD"),
min_abundance  = 0.0001,
min_prevalence = 0.1)
library(Maaslin2)
#load the samples data
samples_data <- read.table("Samples.txt", header=TRUE, row.names=1, sep="\t")
#load the metadata
metadata <- read.table("Metadata.txt", header=TRUE, row.names=1, sep="\t")
#load pathway data
pathway_data <- read.table("Pathways.txt", header=TRUE, row.names=1, sep="\t")
View(metadata)
input_data = system.file(
"extdata", "HMP2_taxonomy.tsv", package="Maaslin2") # The abundance table file
input_data
